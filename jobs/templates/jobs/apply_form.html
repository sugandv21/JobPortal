{% extends 'jobs/base.html' %}
{% block title %}Apply â€” JobPortal{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card shadow-sm">
      <div class="card-body">
        <h3 class="card-title mb-3">
          Apply
          {% if job %}
            to {{ job.title }}
          {% else %}
            to {{ view.job.title }}
          {% endif %}
        </h3>

        <p class="text-muted">Please upload your resume (PDF, DOC, DOCX). Max file size: 5 MB.</p>

        {% if form.non_field_errors %}
          <div class="alert alert-danger">{{ form.non_field_errors }}</div>
        {% endif %}

        <form method="post" enctype="multipart/form-data" novalidate>
          {% csrf_token %}

          <div class="mb-3">
            <label for="{{ form.resume.id_for_label }}" class="form-label">Resume</label>
            {{ form.resume }}
            {% if form.resume.help_text %}
              <div class="form-text">{{ form.resume.help_text }}</div>
            {% else %}
              <div class="form-text">Accepted formats: PDF, DOC, DOCX.</div>
            {% endif %}
            {% if form.resume.errors %}
              <div class="form-text text-danger">{{ form.resume.errors|striptags }}</div>
            {% endif %}
          </div>

          <div class="mb-3">
            <label for="{{ form.cover_letter.id_for_label }}" class="form-label">Cover letter (optional)</label>
            {{ form.cover_letter }}
            {% if form.cover_letter.errors %}
              <div class="form-text text-danger">{{ form.cover_letter.errors|striptags }}</div>
            {% endif %}
          </div>

          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">Submit application</button>
            <a href="{% if job %}{% url 'jobs:job_detail' job.pk %}{% else %}{% url 'jobs:job_detail' view.job.pk %}{% endif %}" class="btn btn-outline-secondary">Cancel</a>
          </div>
        </form>
      </div>
    </div>

    <div class="mt-3 small text-muted">
      <p class="mb-1">Your resume will be stored on the server under the project's media directory. In development this is served via Django when <code>DEBUG=True</code>. For production, serve media from secure storage (S3, CDN with signed URLs, etc.) and ensure resume access is restricted to authorized users.</p>
    </div>
  </div>
</div>
{% endblock %}
